<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Hands–On Data Visualization with ggplot2 – Segment 1 – Cédric Scherer</title>
    <meta charset="utf-8" />
    <meta name="author" content="Cédric Scherer" />
    <meta name="date" content="2021-08-31" />
    <script src="libs/header-attrs-2.9/header-attrs.js"></script>
    <link rel="stylesheet" href="css/style.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

class: inverse, center
background-image: url("img/darklight_RichardStrozynski.jpg")
background-size: contain



&lt;br&gt;&lt;br&gt;
# Hands–On Data Visualization with &lt;code style='color:#ebc500;'&gt;ggplot2&lt;/code&gt;&lt;br&gt;&lt;b style='font-size:25pt;color:#a7a7a7;'&gt;Segment 1: The Grammar of Graphics&lt;/b&gt;
&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
#### Dr. Cédric Scherer&lt;b style='color:#ccba56;font-weight:400;line-height:150%;'&gt;&lt;br&gt;Pearson Live Training Session for O'Reilly&lt;br&gt;December 17, 2021&lt;/b&gt;&lt;br&gt;



---
background-image: url("img/portfolio/Cards.png")
background-position: center
background-size: contain

---
class: center
background-image: url("img/rtidy2.png")
background-size: contain

---
class: inverse, center

### Data Visualizations for Scientific Publications &amp; Talks

.pull-left[
&lt;p style='text-align:center;'&gt;&lt;img src="img/portfolio/Fig2_disease-data_full_log.png" style='width:91%;border-style:solid; border-color:#606060;'&gt;&lt;br&gt;&lt;capinv&gt;Scherer et al. 2019 Journal of Animal Ecology&lt;/capinv&gt;&lt;/p&gt;
]

.pull-right[
&lt;p style='text-align:center;'&gt;&lt;img src="img/portfolio/SwiFCoIBMove_density.png" style='width:92%;border-style:solid; border-color:#606060;'&gt;&lt;br&gt;&lt;capinv&gt;Scherer et al. 2020 Oikos&lt;/capinv&gt;&lt;/p&gt;
&lt;p style='text-align:center;'&gt;&lt;img src="img/portfolio/NLMR_case_study.png" style='width:92%;border-style:solid; border-color:#606060;'&gt;&lt;br&gt;&lt;capinv&gt;Sciaini et al. 2019 Methods in Ecology &amp; Evolution&lt;/capinv&gt;&lt;/p&gt;
]

---
class: inverse, center

### Data Visualizations for Client Projects

&lt;img src="img/portfolio/jupiter_daily_ma_candles.png", height=243px, style="position:absolute; top:16%; left:2%; border-style:solid; border-color:#606060;"&gt;&lt;/img&gt;

&lt;img src="img/portfolio/20201116_FP_2_5_rating_lolli_1.png", height=243px, style="position:absolute; top:16%; left:37.97%; border-style:solid; border-color:#606060;"&gt;&lt;/img&gt;

&lt;img src="img/portfolio/3_time_eandy_highlight_1.png", height=243px, style="position:absolute; top:16%; right:2%; border-style:solid; border-color:#606060;"&gt;&lt;/img&gt;

&lt;img src="img/portfolio/20200514_FP_12_1_statement_boykott_doughnut_1.png", height=259px, style="position:absolute; top:54%; left:2%; border-style:solid; border-color:#606060;"&gt;&lt;/img&gt;

&lt;img src="img/portfolio/20200723_FP_2_jpmorgan_line_change_1.png", height=259px, style="position:absolute; top:54%; left:26.7%; border-style:solid; border-color:#606060;"&gt;&lt;/img&gt;

&lt;img src="img/portfolio/fig_g3.png", height=259px, style="position:absolute; top:54%; right:2%; border-style:solid; border-color:#606060;"&gt;&lt;/img&gt;

---
class: inverse, center

### Data Visualizations as Personal Projects

&lt;img src="img/portfolio/20200630_TT_2020_27_Xmen_annotated.png", height=273px, style="position:absolute; top:14%; left:2%; border-style:solid; border-color:#606060;"&gt;&lt;/img&gt;

&lt;img src="img/portfolio/03_Polygons_GlobalMortality.png", height=273px, style="position:absolute; top:14%; left:32.9%; border-style:solid; border-color:#606060;"&gt;&lt;/img&gt;

&lt;img src="img/portfolio/2020_28_CoffeeRatings.png", height=273px, style="position:absolute; top:14%; right:2%; border-style:solid; border-color:#606060;"&gt;&lt;/img&gt;

&lt;img src="img/portfolio/19_global_change.png", height=266px, style="position:absolute; top:55.6%; left:2%; border-style:solid; border-color:#606060;"&gt;&lt;/img&gt;

&lt;img src="img/portfolio/CheetahMap_rcarto_sd.png", height=266px, style="position:absolute; top:55.6%; right:2%; border-style:solid; border-color:#606060;"&gt;&lt;/img&gt;

---
class: inverse, center
exclude: true

#### cedricscherer.com

&lt;p style='text-align:center;'&gt;&lt;img src="img/portfolio/blog.png" style='width:53%;'&gt;&lt;br&gt;&lt;b style='color:lightgrey;font-size:12pt;'&gt;cedricscherer.netlify.com&lt;/b&gt;&lt;/p&gt;

---
class: inverse, center
exclude: true

.pull-left[
&lt;p style='text-align:center;'&gt;&lt;img src="img/portfolio/blog-tutorial.png" style='width:64%;'&gt;&lt;/p&gt;
]

.pull-right[
&lt;p style='text-align:center;'&gt;&lt;img src="img/portfolio/blog-evol.png" style='width:64%;'&gt;&lt;/p&gt;
]

---
class: inverse, center
exclude: true

#### github.com/z3tt

&lt;p style='text-align:center;'&gt;&lt;img src="img/portfolio/github.png" style='width:46%;'&gt;&lt;br&gt;&lt;b style='color:lightgrey;font-size:12pt;'&gt;github.com/z3tt&lt;/b&gt;

---
class: center, inverse

&lt;br&gt;
&lt;p style="text-align:center;"&gt;&lt;img src="img/ggplot2.png" style="width: 20%"&gt;
&lt;br&gt;&lt;br&gt;

&lt;b style='font-size:28pt;'&gt;&lt;code style='color:#ebc500;'&gt;{ggplot2}&lt;/code&gt; is a system for declaratively creating graphics,&lt;br&gt;based on "The Grammar of Graphics" (Wilkinson, 2005).&lt;/b&gt;

--

&lt;br&gt;
&lt;span style='font-size:22pt;'&gt;You provide the data, tell &lt;code style='color:#ebc500;font-weight:700;'&gt;{ggplot2}&lt;/code&gt; how to &lt;b&gt;map variables to aesthetics&lt;/b&gt;,&lt;br&gt;what graphical primitives to use, and it takes care of the details.&lt;/span&gt;&lt;br&gt;
&lt;br&gt;
&lt;i style='font-size:12pt;color:grey;'&gt;ggplot2 package description&lt;/i&gt;

---
&lt;br&gt;&lt;br&gt;

# Advantages of `{ggplot2}`

&lt;ul style='font-size:22pt;color:#28a87d;font-weight:700;margin: 50px 50px;'&gt;
&lt;li&gt;consistent underlying grammar of graphics (Wilkinson, 2005)&lt;/li&gt;
&lt;/ul&gt;

---
&lt;br&gt;&lt;br&gt;

# Advantages of `{ggplot2}`

&lt;ul style='font-size:22pt;color:#28a87d;font-weight:700;margin: 50px 50px;'&gt;
&lt;li&gt;consistent underlying grammar of graphics (Wilkinson, 2005)&lt;/li&gt;
&lt;br&gt;
&lt;li&gt;very flexible, layered plot specification&lt;/li&gt; 
&lt;/ul&gt;

---
&lt;br&gt;&lt;br&gt;

# Advantages of `{ggplot2}`

&lt;ul style='font-size:22pt;color:#28a87d;font-weight:700;margin: 50px 50px;'&gt;
&lt;li&gt;consistent underlying grammar of graphics (Wilkinson, 2005)&lt;/li&gt;
&lt;br&gt;
&lt;li&gt;very flexible, layered plot specification&lt;/li&gt; 
&lt;br&gt;
&lt;li&gt;theme system for polishing plot appearance&lt;/li&gt;
&lt;/ul&gt;

---
&lt;br&gt;&lt;br&gt;

# Advantages of `{ggplot2}`

&lt;ul style='font-size:22pt;color:#28a87d;font-weight:700;margin: 50px 50px;'&gt;
&lt;li&gt;consistent underlying grammar of graphics (Wilkinson, 2005)&lt;/li&gt;
&lt;br&gt;
&lt;li&gt;very flexible, layered plot specification&lt;/li&gt; 
&lt;br&gt;
&lt;li&gt;theme system for polishing plot appearance&lt;/li&gt;
&lt;br&gt;  
&lt;li&gt;active and helpful community&lt;/li&gt;
&lt;/ul&gt;

---
class: center, middle

&lt;img src="img/ah_ggplot2_exploratory.png" style='width:53%;'&gt;&lt;br&gt;&lt;cap&gt;Illustration by Allison Horst&lt;/cap&gt;

---
class: center, middle

&lt;p style='text-align:center;'&gt;&lt;img src="img/basic_ggplots.png" style='width:80%;'&gt;&lt;br&gt;&lt;cap&gt;Source: Rstudio (ggplot2.tidyverse.org)&lt;/cap&gt;&lt;/p&gt;

---
class: center, middle

&lt;img src="img/ah_ggplot2_masterpiece.png" style='width:64%;'&gt;&lt;br&gt;&lt;cap&gt;Illustration by Allison Horst&lt;/cap&gt;

---
class: inverse, center, middle

# &lt;b style='font-size:70pt;'&gt;The &lt;code style='color:#ebc500;'&gt;{ggplot2}&lt;/code&gt; Showcase&lt;/b&gt;&lt;br&gt;&lt;br&gt;

---
class: inverse, center, middle

&lt;p style='text-align:center;'&gt;&lt;img src="img/showcase/bbc-gallery.png" style='width:90%;'&gt;&lt;br&gt;&lt;capinv&gt;Collection of BBC Graphics&lt;br&gt;&lt;span style='color:grey;font-size:8pt;'&gt;(modified from bbc.github.io/rcookbook)&lt;/span&gt;&lt;/capinv&gt;&lt;/p&gt;

---
class: inverse, center, middle

&lt;p style='text-align:center;'&gt;&lt;img src="img/showcase/bbc-gallery-quote.png" style='width:90%;'&gt;&lt;br&gt;&lt;capinv&gt;Collection of BBC Graphics&lt;br&gt;&lt;span style='color:grey;font-size:8pt;'&gt;(modified from bbc.github.io/rcookbook)&lt;/span&gt;&lt;/capinv&gt;&lt;/p&gt;

---
class: inverse, center, middle

&lt;p style='text-align:center;'&gt;&lt;img src="img/showcase/20201013_OurWorldInData_emissions_1.png" style='width:73%;'&gt;
&lt;br&gt;&lt;capinv&gt;Reworked OurWorldInData Graph&lt;/capinv&gt;&lt;/p&gt;

---
class: inverse, center, middle

&lt;p style='text-align:center;'&gt;&lt;img src="img/showcase/2020_31_PalmerPenguins.png" style='width:32%;'&gt;
&lt;br&gt;&lt;capinv&gt;Contribution to #TidyTuesday 2020/31&lt;/capinv&gt;&lt;/p&gt;

---
class: inverse, center, middle

&lt;p style='text-align:center;'&gt;&lt;img src="img/showcase/21_downwards_not_really_umpf.png" style='width:80%;'&gt;
&lt;br&gt;&lt;capinv&gt;Contribution to #30DayChartChallenge 2021&lt;/capinv&gt;&lt;/p&gt;

---
class: inverse, center, middle

&lt;p style='text-align:center;'&gt;&lt;img src="img/showcase/europe_sprengler.jpeg" style='width:49%;'&gt;&lt;br&gt;&lt;capinv&gt;European Elections by Torsten Sprenger&lt;br&gt;&lt;span style='color:grey;font-size:8pt;'&gt;(twitter.com/spren9er/status/1138000009306234880)&lt;/span&gt;&lt;/capinv&gt;&lt;/p&gt;

---
class: inverse, center, middle

&lt;p style='text-align:center;'&gt;&lt;img src="img/showcase/20200307_TT_2020_08_CarbonFoodprint_alt.png" style='width:73%;'&gt;
&lt;br&gt;&lt;capinv&gt;Contribution to #TidyTuesday&lt;/capinv&gt;&lt;/p&gt;

---
class: inverse, center, middle
exclude: true

&lt;p style='text-align:center;'&gt;&lt;img src="img/showcase/20190908_SWD_2019_09_Uncertainty.png" style='width:73%;'&gt;
&lt;br&gt;&lt;capinv&gt;Contribution to #SWDchallenge&lt;/capinv&gt;&lt;/p&gt;

---
class: inverse, center, middle

&lt;p style='text-align:center;'&gt;&lt;img src="img/showcase/SWD_2020_01_SmallMultiples_grey.png" style='width:100%;'&gt;&lt;br&gt;&lt;capinv&gt;Contribution to #SWDchallenge&lt;/capinv&gt;&lt;/p&gt;

---
class: inverse, center, middle
exclude: true

&lt;p style='text-align:center;'&gt;&lt;img src="img/showcase/20200630_corona_map_yday_latest_1.png" style='width:60%;'&gt;&lt;br&gt;&lt;capinv&gt;Personal Project "The Worst Days So Far"&lt;/capinv&gt;&lt;/p&gt;

---
class: inverse, center, middle

&lt;p style='text-align:center;'&gt;&lt;img src="img/showcase/jack_davison.png" style='width:40%;'&gt;&lt;br&gt;&lt;capinv&gt;#TidyTuesday Contribution by Jack Davison&lt;br&gt;&lt;span style='color:grey;font-size:8pt;'&gt;(github.com/jack-davison/tidytuesday)&lt;/span&gt;&lt;/capinv&gt;&lt;/p&gt;

---
class: inverse, center, middle

&lt;p style='text-align:center;'&gt;&lt;img src="img/showcase/20210131_BES_CheetahMap_rcarto_hd.png" style='width:65%;'&gt;&lt;br&gt;&lt;capinv&gt;Contribution to the BES MoveMap Contest&lt;/capinv&gt;&lt;/p&gt;

---
class: inverse, center, middle

&lt;p style='text-align:center;'&gt;&lt;img src="img/showcase/swiss_map.png" style='width:65%;'&gt;&lt;br&gt;&lt;capinv&gt;Bivariate Choropleth Map by Timo Gossenbacher&lt;br&gt;&lt;span style='color:grey;font-size:8pt;'&gt;(timogrossenbacher.ch/2019/04/bivariate-maps-with-ggplot2-and-sf)&lt;/span&gt;&lt;/capinv&gt;&lt;/p&gt;

---
class: inverse, center, middle

.pull-left[
&lt;p style='text-align:center;'&gt;&lt;img src="img/showcase/gganimate-hurricane.gif" style='width:71%;'&gt;&lt;br&gt;&lt;capinv&gt;Example of the {gganimate} Package&lt;br&gt;&lt;span style='color:grey;font-size:8pt;'&gt;(github.com/thomasp85/gganimate/wiki)&lt;/span&gt;&lt;/capinv&gt;&lt;/p&gt;
]

.pull-right[
&lt;p style='text-align:center;'&gt;&lt;img src="img/showcase/dwd_anim_diff_yrs_short.gif" style='width:100%;'&gt;&lt;br&gt;&lt;capinv&gt;Personal Project&lt;/capinv&gt;&lt;/p&gt;
]

---
class: inverse, center, middle

&lt;p style='text-align:center;'&gt;&lt;img src="img/showcase/genart.png" style='width:71%;'&gt;&lt;br&gt;&lt;capinv&gt;Generative art by Thomas Lin Pedersen&lt;br&gt;&lt;/capinv&gt;&lt;/p&gt;

---
class: inverse, center, middle

# &lt;b style='font-size:70pt;color:#ebc500;'&gt;The Setup&lt;/b&gt;&lt;br&gt;&lt;br&gt;

---

## The Course Material

* **Clone the &lt;a href="https://github.com/z3tt/hands-on-ggplot2-training"&gt;repository&lt;/a&gt;**

&lt;p style='text-align:center;'&gt;&lt;img src="img/setup/repo.png" style='width:69%;'&gt;

---

## The Course Material

* Clone the &lt;a href="https://github.com/z3tt/hands-on-ggplot2-training"&gt;repository&lt;/a&gt;.
* **Open the R Project: `hands-on-ggplot2.Rproj`**

&lt;p style='text-align:center;'&gt;&lt;img src="img/setup/rproj.png" style='width:80%;'&gt;

---

## The Course Material

* Clone the &lt;a href="https://github.com/z3tt/hands-on-ggplot2-training"&gt;repository&lt;/a&gt;.
* Open the R Project: `hands-on-ggplot2.Rproj`
* **Open the first script: `01-grammar.Rmd`**

&lt;p style='text-align:center;'&gt;&lt;img src="img/setup/rstudio-file.png" style='width:69%;'&gt;

---

## The Course Material

* Clone the &lt;a href="https://github.com/z3tt/hands-on-ggplot2-training"&gt;repository&lt;/a&gt;.
* Open the R Project: `hands-on-ggplot2.Rproj`
* Open the first script: `01-grammar.Rmd`
* **Run code locally**

&lt;p style='text-align:center;'&gt;&lt;img src="img/setup/run-code.png" style='width:66%;'&gt;

---

## The Course Material

* Clone the &lt;a href="https://github.com/z3tt/hands-on-ggplot2-training"&gt;repository&lt;/a&gt;.
* Open the R Project: `hands-on-ggplot2.Rproj`
* Open the first script: `01-grammar.Rmd`
* Run code locally or **knit the report**

&lt;p style='text-align:center;'&gt;&lt;img src="img/setup/knit.png" style='width:66%;'&gt;

---

## The Course Material

* Clone the &lt;a href="https://github.com/z3tt/hands-on-ggplot2-training"&gt;repository&lt;/a&gt;.
* Open the R Project: `hands-on-ggplot2.Rproj`
* Open the first script: `01-grammar.Rmd`
* Run code locally or **knit the report**

&lt;p style='text-align:center;'&gt;&lt;img src="img/setup/report.png" style='width:65%;'&gt;

---
background-image: url("img/bg-poll.png")
background-size: cover

## POLL: Do you use Rmarkdown reports?


&lt;ul style='font-size:26pt;margin: 50px 50px;'&gt;
&lt;li style='margin-bottom: 15px;'&gt;No, never heard of it.&lt;/li&gt;
&lt;li style='margin-bottom: 15px;'&gt;No, but I am aware they exist.&lt;/li&gt;
&lt;li style='margin-bottom: 15px;'&gt;Yes, rarely.&lt;/li&gt;
&lt;li style='margin-bottom: 15px;'&gt;Yes, extensively.&lt;/li&gt;
&lt;/ul&gt;

---

## The Package

&lt;span style='font-size:16pt;'&gt;`{ggplot2}` is a **data visualization package** for the programming language `R` created by Hadley Wickham.&lt;/span&gt;


```r
install.packages("ggplot2")
library(ggplot2)
```

--

&lt;span style='font-size:16pt;'&gt;`{ggplot2}` is part of the [`tidyverse`](https://blog.rstudio.org/2016/09/15/tidyverse-1-0-0/), a set of packages to manipulate and explore data.&lt;/span&gt;


```r
install.packages("tidyverse")
library(tidyverse)
```

&lt;p style="text-align:right;"&gt;&lt;img src="img/tidyverse.png" style="width: 58%"&gt;&lt;font color="grey" size=2&gt;&lt;i&gt;Source: dicook.org/files/rstudio/#3&lt;/i&gt;&lt;/font&gt;&lt;/p&gt;

---

## The Data Set

We use **cryptocurrency financial data**, pulled from [CoinMarketCap.com](https://www.kaggle.com/philmohun/cryptocurrency-financial-data).&lt;br&gt;

&lt;p style='text-align:left;'&gt;&lt;img src="img/data-kaggle.png" style='width:59%;'&gt;

---

We limit the data to the period 08/2017–12/2019 and the top 4 cryptocurrencies:

![](./img/data.png)

---
background-image: url("img/bg-poll.png")
background-size: cover

## POLL: Are you into cryptocurrencies?

&lt;ul style='font-size:26pt;margin: 50px 50px;'&gt;
&lt;li style='margin-bottom: 15px;'&gt; No, I don't care.&lt;/li&gt;
&lt;li style='margin-bottom: 15px;'&gt;Yes, I'm keeping an eye on that new technology (passively).&lt;/li&gt;
&lt;li style='margin-bottom: 15px;'&gt;Yes, I am part of the movement.&lt;/li&gt;
&lt;/ul&gt;

---
class: inverse, center, middle

# &lt;b style='font-size:70pt;color:#ebc500;'&gt;Import the Data&lt;/b&gt;&lt;br&gt;&lt;br&gt;

---

## Import the Data

Using the `read_csv()` function form the `{readr}` package, we can read the data directly from the web:


```r
url &lt;- "https://raw.githubusercontent.com/z3tt/hands-on-ggplot2/main/data/crypto_cleaned.csv"

data &lt;- readr::read_csv(url)
```

---

## Short Explanation of `::`

&lt;br&gt;The so–called **namespace** allows to access functions from a package directly without loading it first.

&lt;code style='font-size:30pt;'&gt;packagename::function(argument)&lt;/code&gt;

--

&lt;br&gt;Furthermore, it helps readers to understand from which package a function is imported from.

---

## Import the Data

Using the `read_csv()` function form the `{readr}` package, we can read the data directly from the web:


```r
url &lt;- "https://raw.githubusercontent.com/z3tt/hands-on-ggplot2/main/data/crypto_cleaned.csv"

data &lt;- readr::read_csv(url)

*data
## # A tibble: 2,812 x 9
##    currency     date        open  high   low close  year month  yday
##    &lt;chr&gt;        &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 binance-coin 2019-12-04  15.4  15.7  15.0  15.3  2019    12   338
##  2 binance-coin 2019-12-03  15.2  15.6  15.0  15.3  2019    12   337
##  3 binance-coin 2019-12-02  15.5  15.7  15.2  15.2  2019    12   336
##  4 binance-coin 2019-12-01  15.7  15.7  15.0  15.5  2019    12   335
##  5 binance-coin 2019-11-30  16.3  16.4  15.5  15.7  2019    11   334
##  6 binance-coin 2019-11-29  15.7  16.3  15.6  16.3  2019    11   333
##  7 binance-coin 2019-11-28  16.1  16.2  15.6  15.7  2019    11   332
##  8 binance-coin 2019-11-27  15.5  16.2  14.9  16.1  2019    11   331
##  9 binance-coin 2019-11-26  15.3  15.9  15.2  15.5  2019    11   330
## 10 binance-coin 2019-11-25  15.3  15.7  14.2  15.3  2019    11   329
## # ... with 2,802 more rows
```

---

## Import the Data

Of course, one can import local files as well:


```r
data_local &lt;- readr::read_csv("data/crypto_cleaned.csv")

data_local
## # A tibble: 2,812 x 9
##    currency     date        open  high   low close  year month  yday
##    &lt;chr&gt;        &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 binance-coin 2019-12-04  15.4  15.7  15.0  15.3  2019    12   338
##  2 binance-coin 2019-12-03  15.2  15.6  15.0  15.3  2019    12   337
##  3 binance-coin 2019-12-02  15.5  15.7  15.2  15.2  2019    12   336
##  4 binance-coin 2019-12-01  15.7  15.7  15.0  15.5  2019    12   335
##  5 binance-coin 2019-11-30  16.3  16.4  15.5  15.7  2019    11   334
##  6 binance-coin 2019-11-29  15.7  16.3  15.6  16.3  2019    11   333
##  7 binance-coin 2019-11-28  16.1  16.2  15.6  15.7  2019    11   332
##  8 binance-coin 2019-11-27  15.5  16.2  14.9  16.1  2019    11   331
##  9 binance-coin 2019-11-26  15.3  15.9  15.2  15.5  2019    11   330
## 10 binance-coin 2019-11-25  15.3  15.7  14.2  15.3  2019    11   329
## # ... with 2,802 more rows
```

--

This assumes that you have placed the file in a folder called `data` in your working directory.  
You can specify this directory via `setwd()` or, and preferably, use R projects.

---
background-image: url("img/bg-exercise.png")
background-size: cover

## Exercise 1:

* Import the data set on Chicago weather data:&lt;br&gt;https://raw.githubusercontent.com/z3tt/ggplot-courses/master/data/chicago-nmmaps.csv
  
* Inspect the data.

---

## Exercise 1: Import the Data


```r
chic &lt;- readr::read_csv(
  "https://raw.githubusercontent.com/z3tt/ggplot-courses/master/data/chicago-nmmaps.csv"
)

# chic &lt;- readr::read_csv("data/chicago-nmmaps.csv")
```

---

## Exercise 1: Inspect the Data


```r
tibble::glimpse(chic)
## Rows: 1,461
## Columns: 10
## $ city     &lt;chr&gt; "chic", "chic", "chic", "chic", "chic", "chic", "chic", "chic~
## $ date     &lt;date&gt; 1997-01-01, 1997-01-02, 1997-01-03, 1997-01-04, 1997-01-05, ~
## $ death    &lt;dbl&gt; 137, 123, 127, 146, 102, 127, 116, 118, 148, 121, 110, 127, 1~
## $ temp     &lt;dbl&gt; 36.0, 45.0, 40.0, 51.5, 27.0, 17.0, 16.0, 19.0, 26.0, 16.0, 1~
## $ dewpoint &lt;dbl&gt; 37.500, 47.250, 38.000, 45.500, 11.250, 5.750, 7.000, 17.750,~
## $ pm10     &lt;dbl&gt; 13.052268, 41.948600, 27.041751, 25.072573, 15.343121, 9.3646~
## $ o3       &lt;dbl&gt; 5.659256, 5.525417, 6.288548, 7.537758, 20.760798, 14.940874,~
## $ time     &lt;dbl&gt; 3654, 3655, 3656, 3657, 3658, 3659, 3660, 3661, 3662, 3663, 3~
## $ season   &lt;chr&gt; "Winter", "Winter", "Winter", "Winter", "Winter", "Winter", "~
## $ year     &lt;dbl&gt; 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1~
```

---

## Exercise 1: Inspect the Data


```r
summary(chic)
##      city                date                death            temp   
##  Length:1461        Min.   :1997-01-01   Min.   : 69.0   Min.   :-3  
##  Class :character   1st Qu.:1998-01-01   1st Qu.:101.0   1st Qu.:36  
##  Mode  :character   Median :1999-01-01   Median :110.0   Median :52  
##                     Mean   :1999-01-01   Mean   :111.3   Mean   :51  
##                     3rd Qu.:2000-01-01   3rd Qu.:120.0   3rd Qu.:67  
##                     Max.   :2000-12-31   Max.   :164.0   Max.   :90  
##                                                                      
##     dewpoint           pm10                o3                time     
##  Min.   :-10.38   Min.   :  0.2033   Min.   : 0.08584   Min.   :3654  
##  1st Qu.: 28.10   1st Qu.: 18.3844   1st Qu.:10.92419   1st Qu.:4019  
##  Median : 41.20   Median : 28.8499   Median :18.65149   Median :4384  
##  Mean   : 41.36   Mean   : 32.0928   Mean   :19.23597   Mean   :4384  
##  3rd Qu.: 56.25   3rd Qu.: 41.0738   3rd Qu.:26.20476   3rd Qu.:4749  
##  Max.   : 77.10   Max.   :125.3844   Max.   :54.68764   Max.   :5114  
##                   NA's   :17                                          
##     season               year     
##  Length:1461        Min.   :1997  
##  Class :character   1st Qu.:1998  
##  Mode  :character   Median :1999  
##                     Mean   :1999  
##                     3rd Qu.:2000  
##                     Max.   :2000  
## 
```

---

## Exercise 1: Inspect the Data


```r
range(chic$date)
## [1] "1997-01-01" "2000-12-31"

range(chic$temp)
## [1] -3 90

unique(chic$season)
## [1] "Winter" "Spring" "Summer" "Autumn"

unique(chic$year)
## [1] 1997 1998 1999 2000
```

---
class: inverse, center, middle

# &lt;b style='font-size:70pt;'&gt;The Structure of&lt;br&gt;&lt;code style='color:#ebc500;'&gt;{ggplot2}&lt;/code&gt;&lt;/b&gt;&lt;br&gt;&lt;br&gt;
# &lt;span style='font-size:40pt;color:#a7a7a7;'&gt;"The Grammar of Graphics"&lt;/span&gt;&lt;br&gt;&lt;br&gt;

---

## The Structure of &lt;code style='font-weight:700;'&gt;{ggplot2}&lt;/code&gt;

&lt;br&gt;
&lt;table style='width:100%;font-size:15pt;font-family:DM Sans;'&gt;
  &lt;tr&gt;
    &lt;th&gt;Layer&lt;/th&gt;
    &lt;th&gt;Function&lt;/th&gt;
    &lt;th&gt;Explanation&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;b style='color:#67676;'&gt;Data&lt;/b&gt;&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;ggplot(data)&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;The raw data that you want to visualise.&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;b style='color:#67676;'&gt;Aesthetics&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&lt;/b&gt;&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;aes()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;Aesthetic mappings of the geometric and statistical objects.&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;b style='color:#67676;'&gt;Layers&lt;/b&gt;&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;geom_*()&lt;/code&gt; and&amp;nbsp;&amp;nbsp;&lt;code&gt;stat_*()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;The geometric shapes and statistical summaries representing the data.&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

---

## The Structure of &lt;code style='font-weight:700;'&gt;{ggplot2}&lt;/code&gt;

&lt;br&gt;
&lt;table style='width:100%;font-size:15pt;font-family:DM Sans;'&gt;
  &lt;tr&gt;
    &lt;th&gt;Layer&lt;/th&gt;
    &lt;th&gt;Function&lt;/th&gt;
    &lt;th&gt;Explanation&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;b style='color:#67676;'&gt;Data&lt;/b&gt;&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;ggplot(data)&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;The raw data that you want to visualise.&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;b style='color:#67676;'&gt;Aesthetics&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&lt;/b&gt;&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;aes()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;Aesthetic mappings of the geometric and statistical objects.&lt;/td&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;b style='color:#67676;'&gt;Layers&lt;/b&gt;&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;geom_*()&lt;/code&gt; and&amp;nbsp;&amp;nbsp;&lt;code&gt;stat_*()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;The geometric shapes and statistical summaries representing the data.&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;b style='color:#67676;'&gt;Scales&lt;/b&gt;&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;scale_*()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;Maps between the data and the aesthetic dimensions.&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;b style='color:#67676;'&gt;Coordinate System&lt;/b&gt;&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;coord_*()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;Maps data into the plane of the data rectangle.&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;b style='color:#67676;'&gt;Facets&lt;/b&gt;&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;facet_*()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;The arrangement of the data into a grid of plots.&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;b style='color:#67676;'&gt;Visual Themes&lt;/b&gt;&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;theme()&lt;/code&gt; and&amp;nbsp;&amp;nbsp;&lt;code&gt;theme_*()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;The overall visual defaults of a plot.&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

---

## The Structure of &lt;code style='font-weight:700;'&gt;{ggplot2}&lt;/code&gt;

&lt;br&gt;
&lt;table style='width:100%;font-size:15pt;font-family:DM Sans;'&gt;
  &lt;tr&gt;
    &lt;th&gt;Layer&lt;/th&gt;
    &lt;th&gt;Function&lt;/th&gt;
    &lt;th&gt;Explanation&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;b style='color:#67676;'&gt;Data&lt;/b&gt;&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;ggplot(data)&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;The raw data that you want to visualise.&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;b style='color:#67676;'&gt;Aesthetics&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&lt;/b&gt;&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;aes()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;Aesthetic mappings of the geometric and statistical objects.&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;b style='color:#67676;'&gt;Layers&lt;/b&gt;&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;geom_*()&lt;/code&gt; and&amp;nbsp;&amp;nbsp;&lt;code&gt;stat_*()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;The geometric shapes and statistical summaries representing the data.&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;b style='color:#67676;'&gt;Scales&lt;/b&gt;&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;scale_*()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;Maps between the data and the aesthetic dimensions.&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;b style='color:#67676;'&gt;Coordinate System&lt;/b&gt;&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;coord_*()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;Maps data into the plane of the data rectangle.&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;b style='color:#67676;'&gt;Facets&lt;/b&gt;&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;facet_*()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;The arrangement of the data into a grid of plots.&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;b style='color:#67676;'&gt;Visual Themes&lt;/b&gt;&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;theme()&lt;/code&gt; and&amp;nbsp;&amp;nbsp;&lt;code&gt;theme_*()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;The overall visual defaults of a plot.&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;b style='color:#67676;'&gt;Annotations&lt;/b&gt;&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;annotate()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;Add additional labels, geometries or images to a plot.&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

---

## Data: &lt;code style='font-weight:700;'&gt;ggplot(data)&lt;/code&gt;

We need to specify the data in the `ggplot()` call:


```r
*ggplot(data = data)
```

&lt;img src="01-grammar_files/figure-html/structure-data-1.png" width="1152" style="display: block; margin: auto;" /&gt;

---

## Data: &lt;code style='font-weight:700;'&gt;ggplot(data)&lt;/code&gt;

We need to specify the data in the `ggplot()` call:


```r
*ggplot(data = data)
```

&lt;img src="01-grammar_files/figure-html/structure-data-repeat-1.png" width="1152" style="display: block; margin: auto;" /&gt;

There is only an empty panel because `{ggplot2}` doesn't know **what** of the data it should plot.

---

## Aesthetics: &lt;code style='font-weight:700;'&gt;aes()&lt;/code&gt;

We need to specify two variables we want to plot as positional `aes`thetics:


```r
*ggplot(data = data, mapping = aes(x = date, y = close))
```

&lt;img src="01-grammar_files/figure-html/structure-aes-1.png" width="1152" style="display: block; margin: auto;" /&gt;

---

## Aesthetics: &lt;code style='font-weight:700;'&gt;aes()&lt;/code&gt;

We need to specify two variables we want to plot as positional `aes`thetics:


```r
*ggplot(data = data, mapping = aes(x = date, y = close))
```

&lt;img src="01-grammar_files/figure-html/structure-aes-repeat-1.png" width="1152" style="display: block; margin: auto;" /&gt;

There is only an empty panel because `{ggplot2}` doesn't know **how** it should plot the data.

---

## &lt;code style='font-weight:700;'&gt;ggplot(data, aes(x, y))&lt;/code&gt;

Thanks to implicit matching of arguments in `ggplot()` and `aes()`, we can also write:


```r
*ggplot(data, aes(date, close))
```

&lt;img src="01-grammar_files/figure-html/structure-aes-implicit-1.png" width="1152" style="display: block; margin: auto;" /&gt;

---

## Layers: &lt;code style='font-weight:700;'&gt;geom\_\*()&lt;/code&gt;&amp;nbsp;&amp;nbsp;and&amp;nbsp;&amp;nbsp;&lt;code&gt;stat_*()&lt;/code&gt;

By adding one or multiple layers we can tell `{ggplot2}` *how*&amp;nbsp;&amp;nbsp;to represent the data.&lt;br&gt;
There are lots of built-in geometric elements (`geom's`) and statistical transformations (`stat's`):

&lt;p style="text-align:center;"&gt;&lt;img src="img/ggplot-layers.png" style="width: 54%"&gt;&lt;i style='font-size:10pt;color:grey;'&gt;Adapted from ggplot2.tidyverse.org/reference&lt;/i&gt;&lt;/p&gt;

---

## Layers: &lt;code style='font-weight:700;'&gt;geom_*()&lt;/code&gt;

We can tell `{ggplot2}` to represent the data for example as a **scatter plot**:


```r
ggplot(data, aes(date, close)) +
* geom_point()
```

&lt;img src="01-grammar_files/figure-html/structure-geom-point-1.png" width="1152" style="display: block; margin: auto;" /&gt;

---

## Aesthetics: &lt;code style='font-weight:700;'&gt;aes()&lt;/code&gt;

Aesthetics do not only refer to x and y positions, but also groupings, colors, fills, shapes etc.


```r
*ggplot(data = data, mapping = aes(x = date, y = close, color = currency)) +
  geom_point()
```

&lt;img src="01-grammar_files/figure-html/structure-aes-point-groups-1.png" width="1152" style="display: block; margin: auto;" /&gt;

---

## Important Things First: Change the Default Theme


```r
*theme_set(theme_light(base_size = 18))
```

---

## Important Things First: Change the Default Theme


```r
theme_set(theme_light(base_size = 18))

ggplot(data = data, mapping = aes(x = date, y = close, color = currency)) + 
  geom_point()
```

&lt;img src="01-grammar_files/figure-html/theme-plot-eval-1.png" width="1152" style="display: block; margin: auto;" /&gt;

---

## Layers: &lt;code style='font-weight:700;'&gt;geom\_\*()&lt;/code&gt; and &lt;code style='font-weight:700;'&gt;stat_*()&lt;/code&gt;

The exciting thing about layers is that you can combine several `geom_*()` and `stat_*()` calls:


```r
ggplot(data, aes(date, close, color = currency)) +
* geom_line() +
* geom_point()
```

&lt;img src="01-grammar_files/figure-html/structure-geom-point-smooth-1.png" width="1152" style="display: block; margin: auto;" /&gt;

---

## Layers: &lt;code style='font-weight:700;'&gt;geom\_\*()&lt;/code&gt; and &lt;code style='font-weight:700;'&gt;stat_*()&lt;/code&gt;

... and aesthetics can be applied either **globally** or for each layer individually:


```r
*ggplot(data, aes(date, close, color = currency, shape = currency)) +
  geom_line() +
  geom_point()
```

&lt;img src="01-grammar_files/figure-html/structure-geom-point-smooth-aes-global-1.png" width="1152" style="display: block; margin: auto;" /&gt;

---

## Layers: &lt;code style='font-weight:700;'&gt;geom\_\*()&lt;/code&gt; and &lt;code style='font-weight:700;'&gt;stat_*()&lt;/code&gt;

... and aesthetics can be applied either globally or for each layer **individually**:


```r
ggplot(data, aes(date, close)) +
* geom_line(aes(color = currency)) +
* geom_point(aes(shape = currency))
```

&lt;img src="01-grammar_files/figure-html/structure-geom-point-smooth-aes-individual-1.png" width="1152" style="display: block; margin: auto;" /&gt;

---
background-image: url("img/bg-exercise.png")
background-size: cover

## Exercise 2:

* If needed, import the Chicago weather data again:


```r
chic &lt;- readr::read_csv(
  "https://raw.githubusercontent.com/z3tt/ggplot-courses/master/data/chicago-nmmaps.csv"
)
```

* Create a scatter plot of temperature (`temp`) versus day (`date`).

* Color the points by season (`season`).

* Color the points by year (`year`).
  + What's the problem? How could you fix it?

---
background-image: url("img/bg-exercise.png")
background-size: cover

## Exercise 2:

* If needed, import the Chicago weather data again:


```r
chic &lt;- readr::read_csv(
  "https://raw.githubusercontent.com/z3tt/ggplot-courses/master/data/chicago-nmmaps.csv"
)
```

* Create a scatter plot of temperature (`temp`) versus day (`date`).

* Color the points by season (`season`).

* Color the points by year (`year`).
  + What's the problem? How could you fix it?

* **Bonus:** Turn the scatter plot, colored by season, into a line plot.
  + What's the problem? How could you fix it?

---

## Exercise 2: Scatter Plot Temperature vs Day


```r
ggplot(chic, aes(date, temp)) + 
  geom_point()
```

&lt;img src="01-grammar_files/figure-html/plot-chic-scatter-1.png" width="1152" style="display: block; margin: auto;" /&gt;

---

## Exercise 2: Scatter Plot Colored by Season


```r
ggplot(chic, aes(date, temp, color = season)) + 
  geom_point()
```

&lt;img src="01-grammar_files/figure-html/plot-chic-scatter-season-1.png" width="1152" style="display: block; margin: auto;" /&gt;

---

## Exercise 2: Scatter Plot Colored by Year


```r
ggplot(chic, aes(date, temp, color = year)) + 
  geom_point()
```

&lt;img src="01-grammar_files/figure-html/plot-chic-scatter-year-cont-1.png" width="1152" style="display: block; margin: auto;" /&gt;

---
background-image: url("img/bg-poll.png")
background-size: cover

## POLL: The variable &lt;code&gt;year&lt;/code&gt; should be of type... (MC)


&lt;ul style='font-size:26pt;margin: 50px 50px;'&gt;
&lt;li style='margin-bottom: 15px;'&gt;Integer&lt;/li&gt;
&lt;li style='margin-bottom: 15px;'&gt;Character&lt;/li&gt;
&lt;li style='margin-bottom: 15px;'&gt;Factor&lt;/li&gt;
&lt;li style='margin-bottom: 15px;'&gt;Date&lt;/li&gt;
&lt;/ul&gt;

---

## Exercise 2: Scatter Plot Colored by Year


```r
ggplot(chic, aes(date, temp, color = factor(year))) + 
  geom_point()
```

&lt;img src="01-grammar_files/figure-html/plot-chic-scatter-year-fct-1.png" width="1152" style="display: block; margin: auto;" /&gt;

---

## Exercise 2: Scatter Plot Colored by Year


```r
ggplot(chic, aes(date, temp, color = as.character(year))) + 
  geom_point()
```

&lt;img src="01-grammar_files/figure-html/plot-chic-scatter-year-char-1.png" width="1152" style="display: block; margin: auto;" /&gt;

---

## Exercise 2: Scatter Plot Colored by Year


```r
ggplot(chic, aes(date, temp, color = as.integer(year))) + 
  geom_point()
```

&lt;img src="01-grammar_files/figure-html/plot-chic-scatter-year-int-1.png" width="1152" style="display: block; margin: auto;" /&gt;

---

## Exercise 2 — Bonus: Scatter Plot Colored by Year


```r
ggplot(chic, aes(date, temp, color = season)) + 
  geom_line()
```

&lt;img src="01-grammar_files/figure-html/plot-chic-line-season-1.png" width="1152" style="display: block; margin: auto;" /&gt;

---

## Exercise 2 — Bonus: Scatter Plot Colored by Year


```r
ggplot(chic, aes(date, temp, color = season, group = year)) + 
  geom_line()
```

&lt;img src="01-grammar_files/figure-html/plot-chic-line-season-fixed-1.png" width="1152" style="display: block; margin: auto;" /&gt;

---
class: center, middle

&lt;b style='font-family:DM Serif;font-size:40pt;color:#28a87d;font-weight:600;'&gt;Scales, Coordinate Systems, Facets,&lt;br&gt;Themes, and Annotations will follow later!&lt;/b&gt;&lt;br&gt;&lt;br&gt;

---

## Saving a `ggplot`

You can export your plot via the `ggsave()` function:


```r
ggsave(filename = "my_ggplot.pdf", 
       width = 10, height = 7, 
       device = cairo_pdf)

ggsave(filename = "my_ggplot.png", 
       width = 10, height = 7, 
       dpi = 700)
```

---
class: center, middle

&lt;img src="img/canva_vector.png" style='width:100%;'&gt;&lt;br&gt;&lt;i style='font-size:10pt;color:grey;'&gt;Source: canva.com&lt;/i&gt;

---

## Resources

* [“ggplot2: Elegant Graphics for Data Analysis”](https://ggplot2-book.org/), free–access book by Hadley Wickham et al.

* [{ggplot2} reference](https://ggplot2.tidyverse.org/reference/)

* [{ggplot2} cheatsheet](https://github.com/rstudio/cheatsheets/raw/master/data-visualization-2.1.pdf)

* [“R for Data Science”](https://4ds.had.co.nz), free–access book by Hadley Wickham

* [“Data Visualization: A Practical Introduction”](https://socviz.co), free–access book  by Kieran Healy

* [“A `{ggplot2}` Tutorial for Beautiful Plotting in R”](https://www.cedricscherer.com/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r/), my extensive "how to"-tutorial

---
class: inverse, center, middle

# &lt;b style='font-size:70pt;color:lightgray;'&gt;APPENDIX&lt;/b&gt;&lt;br&gt;&lt;br&gt;

---

## Import the Data

A good workflow when working with local files is offered by the `{here}` package in combination with R projects:


```r
here::here()
## [1] "C:/Users/DataVizard/Google Drive/Work/DataViz/Teaching/2021_OReilly_Trainings/hands-on-ggplot2"

data_local &lt;- readr::read_csv(here::here("data", "crypto_cleaned.csv"))

data_local
## # A tibble: 2,812 x 9
##    currency     date        open  high   low close  year month  yday
##    &lt;chr&gt;        &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 binance-coin 2019-12-04  15.4  15.7  15.0  15.3  2019    12   338
##  2 binance-coin 2019-12-03  15.2  15.6  15.0  15.3  2019    12   337
##  3 binance-coin 2019-12-02  15.5  15.7  15.2  15.2  2019    12   336
##  4 binance-coin 2019-12-01  15.7  15.7  15.0  15.5  2019    12   335
##  5 binance-coin 2019-11-30  16.3  16.4  15.5  15.7  2019    11   334
##  6 binance-coin 2019-11-29  15.7  16.3  15.6  16.3  2019    11   333
##  7 binance-coin 2019-11-28  16.1  16.2  15.6  15.7  2019    11   332
##  8 binance-coin 2019-11-27  15.5  16.2  14.9  16.1  2019    11   331
##  9 binance-coin 2019-11-26  15.3  15.9  15.2  15.5  2019    11   330
## 10 binance-coin 2019-11-25  15.3  15.7  14.2  15.3  2019    11   329
## # ... with 2,802 more rows
```

---

## Import the Data

The base R function `read.csv()` works in the same way as `readr::read_csv()`:


```r
data &lt;- read.csv(here::here("data", "crypto_cleaned.csv"))

head(data)
##       currency       date  open  high   low close year month yday
## 1 binance-coin 2019-12-04 15.35 15.69 15.01 15.28 2019    12  338
## 2 binance-coin 2019-12-03 15.19 15.55 15.05 15.31 2019    12  337
## 3 binance-coin 2019-12-02 15.51 15.71 15.15 15.19 2019    12  336
## 4 binance-coin 2019-12-01 15.74 15.74 15.05 15.50 2019    12  335
## 5 binance-coin 2019-11-30 16.26 16.37 15.54 15.72 2019    11  334
## 6 binance-coin 2019-11-29 15.68 16.34 15.65 16.27 2019    11  333
```

---

## Import the Data

... and we can turn it into a **tibble** afterwards:


```r
data &lt;- tibble::as_tibble(data)

data
## # A tibble: 2,812 x 9
##    currency     date        open  high   low close  year month  yday
##    &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1 binance-coin 2019-12-04  15.4  15.7  15.0  15.3  2019    12   338
##  2 binance-coin 2019-12-03  15.2  15.6  15.0  15.3  2019    12   337
##  3 binance-coin 2019-12-02  15.5  15.7  15.2  15.2  2019    12   336
##  4 binance-coin 2019-12-01  15.7  15.7  15.0  15.5  2019    12   335
##  5 binance-coin 2019-11-30  16.3  16.4  15.5  15.7  2019    11   334
##  6 binance-coin 2019-11-29  15.7  16.3  15.6  16.3  2019    11   333
##  7 binance-coin 2019-11-28  16.1  16.2  15.6  15.7  2019    11   332
##  8 binance-coin 2019-11-27  15.5  16.2  14.9  16.1  2019    11   331
##  9 binance-coin 2019-11-26  15.3  15.9  15.2  15.5  2019    11   330
## 10 binance-coin 2019-11-25  15.3  15.7  14.2  15.3  2019    11   329
## # ... with 2,802 more rows
```

However, note that by default the date column is turned into type `character`.

---

## Import the Data

The `import()` function from the `{rio}` package allows to load all kind of data formats:


```r
data &lt;- rio::import(here::here("data", "crypto_cleaned.csv"), setclass = "tbl")

data
## # A tibble: 2,812 x 9
##    currency     date        open  high   low close  year month  yday
##    &lt;chr&gt;        &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1 binance-coin 2019-12-04  15.4  15.7  15.0  15.3  2019    12   338
##  2 binance-coin 2019-12-03  15.2  15.6  15.0  15.3  2019    12   337
##  3 binance-coin 2019-12-02  15.5  15.7  15.2  15.2  2019    12   336
##  4 binance-coin 2019-12-01  15.7  15.7  15.0  15.5  2019    12   335
##  5 binance-coin 2019-11-30  16.3  16.4  15.5  15.7  2019    11   334
##  6 binance-coin 2019-11-29  15.7  16.3  15.6  16.3  2019    11   333
##  7 binance-coin 2019-11-28  16.1  16.2  15.6  15.7  2019    11   332
##  8 binance-coin 2019-11-27  15.5  16.2  14.9  16.1  2019    11   331
##  9 binance-coin 2019-11-26  15.3  15.9  15.2  15.5  2019    11   330
## 10 binance-coin 2019-11-25  15.3  15.7  14.2  15.3  2019    11   329
## # ... with 2,802 more rows
```

---

## Import the Data

The `import()` function from the `{rio}` package allows to load all kind of data formats:


```r
data_json &lt;- rio::import(here::here("data", "crypto_cleaned.json"))

data_json &lt;- as_tibble(data_json) ## somehow `setclass` doesn't work with json

data_json
## # A tibble: 3,424 x 9
##    currency     date        open  high   low close  year month  yday
##    &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1 binance-coin 2019-12-04  15.4  15.7  15.0  15.3  2019    12   338
##  2 binance-coin 2019-12-03  15.2  15.6  15.0  15.3  2019    12   337
##  3 binance-coin 2019-12-02  15.5  15.7  15.2  15.2  2019    12   336
##  4 binance-coin 2019-12-01  15.7  15.7  15.0  15.5  2019    12   335
##  5 binance-coin 2019-11-30  16.3  16.4  15.5  15.7  2019    11   334
##  6 binance-coin 2019-11-29  15.7  16.3  15.6  16.3  2019    11   333
##  7 binance-coin 2019-11-28  16.1  16.2  15.6  15.7  2019    11   332
##  8 binance-coin 2019-11-27  15.5  16.2  14.9  16.1  2019    11   331
##  9 binance-coin 2019-11-26  15.3  15.9  15.2  15.5  2019    11   330
## 10 binance-coin 2019-11-25  15.3  15.7  14.2  15.3  2019    11   329
## # ... with 3,414 more rows
```

---

## Import the Data

The `import()` function from the `{rio}` package allows to load all kind of data formats:


```r
data_xlsx &lt;- rio::import(here::here("data", "crypto_cleaned.xlsx"), setclass = "tbl")

data_xlsx
## # A tibble: 2,812 x 10
##    ...1  currency  date                 open  high   low close  year month  yday
##    &lt;chr&gt; &lt;chr&gt;     &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 1     binance-~ 2019-12-04 00:00:00  15.4  15.7  15.0  15.3  2019    12   338
##  2 2     binance-~ 2019-12-03 00:00:00  15.2  15.6  15.0  15.3  2019    12   337
##  3 3     binance-~ 2019-12-02 00:00:00  15.5  15.7  15.2  15.2  2019    12   336
##  4 4     binance-~ 2019-12-01 00:00:00  15.7  15.7  15.0  15.5  2019    12   335
##  5 5     binance-~ 2019-11-30 00:00:00  16.3  16.4  15.5  15.7  2019    11   334
##  6 6     binance-~ 2019-11-29 00:00:00  15.7  16.3  15.6  16.3  2019    11   333
##  7 7     binance-~ 2019-11-28 00:00:00  16.1  16.2  15.6  15.7  2019    11   332
##  8 8     binance-~ 2019-11-27 00:00:00  15.5  16.2  14.9  16.1  2019    11   331
##  9 9     binance-~ 2019-11-26 00:00:00  15.3  15.9  15.2  15.5  2019    11   330
## 10 10    binance-~ 2019-11-25 00:00:00  15.3  15.7  14.2  15.3  2019    11   329
## # ... with 2,802 more rows
```

---

## Import the Data

We can remove the first column by using the `select()` function from the `{dplyr}` package:


```r
data_xlsx &lt;- dplyr::select(data_xlsx, -1)
#data_xlsx &lt;- dplyr::select(data_xlsx, currency:yday)

data_xlsx
## # A tibble: 2,812 x 9
##    currency     date                 open  high   low close  year month  yday
##    &lt;chr&gt;        &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 binance-coin 2019-12-04 00:00:00  15.4  15.7  15.0  15.3  2019    12   338
##  2 binance-coin 2019-12-03 00:00:00  15.2  15.6  15.0  15.3  2019    12   337
##  3 binance-coin 2019-12-02 00:00:00  15.5  15.7  15.2  15.2  2019    12   336
##  4 binance-coin 2019-12-01 00:00:00  15.7  15.7  15.0  15.5  2019    12   335
##  5 binance-coin 2019-11-30 00:00:00  16.3  16.4  15.5  15.7  2019    11   334
##  6 binance-coin 2019-11-29 00:00:00  15.7  16.3  15.6  16.3  2019    11   333
##  7 binance-coin 2019-11-28 00:00:00  16.1  16.2  15.6  15.7  2019    11   332
##  8 binance-coin 2019-11-27 00:00:00  15.5  16.2  14.9  16.1  2019    11   331
##  9 binance-coin 2019-11-26 00:00:00  15.3  15.9  15.2  15.5  2019    11   330
## 10 binance-coin 2019-11-25 00:00:00  15.3  15.7  14.2  15.3  2019    11   329
## # ... with 2,802 more rows
```

---

## &lt;code style='font-weight:700;'&gt;ggplot(data) + aes(x, y)&lt;/code&gt;

Some prefer to place the `aes()` outside the `ggplot()` call:


```r
*ggplot(data) +
* aes(x = date, y = close)
```

&lt;img src="01-grammar_files/figure-html/structure-aes-outside-1.png" width="1152" style="display: block; margin: auto;" /&gt;

---

## Coordinate Systems: &lt;code style='font-weight:700;'&gt;coord\_\*()&lt;/code&gt;

The coordinate system maps the two position to a 2d position on the plot:

.pull-left[

```r
ggplot(data, aes(x = date, y = close, 
                 color = currency)) +
  geom_line() +
  geom_point() +
  scale_x_date() + 
  scale_y_continuous() + 
  scale_color_discrete() +
* coord_cartesian()
```
]

.pull-right[
&lt;img src="01-grammar_files/figure-html/plot-structure-coord-1.png" width="504" style="display: block; margin: auto;" /&gt;
]

---

## Coordinate Systems: &lt;code style='font-weight:700;'&gt;coord\_\*()&lt;/code&gt;

The coordinate system maps the two position to a 2d position on the plot:

.pull-left[

```r
ggplot(data, aes(x = date, y = close, 
                 color = currency)) +
  geom_line() +
  geom_point() +
  scale_x_date() + 
  scale_y_continuous() + 
  scale_color_discrete() +
* coord_polar()
```
]

.pull-right[
&lt;img src="01-grammar_files/figure-html/plot-structure-coord-polar-1.png" width="504" style="display: block; margin: auto;" /&gt;
]

---

## Coordinate Systems: &lt;code style='font-weight:700;'&gt;coord\_\*()&lt;/code&gt;

Changing the limits on the coordinate system allows to zoom in:

.pull-left[

```r
ggplot(data, aes(x = date, y = close, 
                 color = currency)) +
  geom_line() +
  geom_point() +
  scale_x_date() + 
  scale_y_continuous() + 
  scale_color_discrete() +
  coord_cartesian(
*   xlim = c(as.Date("2018-11-01"),
*            as.Date("2019-11-01")),
*   ylim = c(NA, 100)
  )
```
]

.pull-right[
&lt;img src="01-grammar_files/figure-html/plot-structure-coord-zoom-1.png" width="504" style="display: block; margin: auto;" /&gt;
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"slideNumberFormat": "<div class=\"progress-bar-container\">\n  <div class=\"progress-bar\" style=\"width: calc(%current% / %total% * 100%);\">\n  </div>\n</div>\n",
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
